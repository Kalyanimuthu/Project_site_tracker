{% extends "base.html" %}
{% load static %}
{% block content %}

<style>
/* --- GLOBAL STYLE IMPROVEMENTS --- */
body {
    background: #f5f6fa;
}

/* --- HEADER AREA --- */
.page-title {
    font-weight: 800;
    font-size: 32px;
    display: flex;
    align-items: center;
    gap: 10px;
}

/* --- CARD DESIGN --- */
.site-card {
    background: linear-gradient(135deg, #ffffff 0%, #f2f7ff 100%);
    border-radius: 22px;
    padding: 22px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.10);
    transition: 0.25s ease;
    position: relative;
    overflow: hidden;
}

.site-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.18);
}

/* Colored left strip */
.card-accent {
    width: 10px;
    height: 100%;
    border-radius: 10px 0 0 10px;
    position: absolute;
    left: 0;
    top: 0;
}

/* --- VIEW BUTTON --- */
.view-btn {
    background: #007bff;
    padding: 9px 20px;
    border-radius: 10px;
    color: white;
    font-weight: 600;
    font-size: 14px;
    letter-spacing: 0.3px;
    transition: 0.2s;
}

.view-btn:hover {
    background: #005fcc;
}

/* --- ADD BUTTON --- */
.add-btn {
    background: #ff8a00;
    color: white;
    padding: 10px 20px;
    border-radius: 14px;
    font-weight: 700;
    font-size: 15px;
    transition: 0.2s;
}

.add-btn:hover {
    background: #e67600;
}

/* --- GRID LAYOUT --- */
.grid-box {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
    gap: 25px;
}

/* --- SEARCH BAR --- */
#searchBox {
    border-radius: 14px;
    padding: 12px 18px;
    font-size: 16px;
    background: #ffffff url('https://cdn-icons-png.flaticon.com/512/622/622669.png') no-repeat 15px center;
    background-size: 20px;
    padding-left: 45px;
    box-shadow: 0px 4px 10px rgba(0,0,0,0.08);
}

</style>

<div class="container mt-4">

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="page-title">
            <img src="https://cdn-icons-png.flaticon.com/512/684/684908.png" width="36">
            Site Manager
        </h2>

        <div class="d-flex gap-2">
            <a href="{% url 'all_sites_total' %}" class="btn btn-dark">
                üí∞ All Sites Total
            </a>
            <a href="{% url 'section_filter' %}" class="btn btn-info text-white">
                üîç Section Filter
            </a>
            <a href="{% url 'reset_all_data' %}" 
                class="btn btn-danger text-white"
                onclick="return confirm('Are you sure? This will reset all payments and counts!');">
                    üîÑ Reset All Data
            </a>

            <a href="{% url 'site_create' %}" class="add-btn">
                + Add Site
            </a>
        </div>
    </div>

    <!-- Search -->
    <input type="text" id="searchBox" class="form-control shadow-sm mb-4"
           placeholder="Search site..." onkeyup="searchSites()">

    <!-- Card Grid -->
    <div class="grid-box" id="siteGrid">

        {% for s in sites %}
        <div class="site-card site-item">
            <div class="card-accent" style="background: {% cycle '#ff6b6b' '#4d9bff' '#41d6a5' '#f7b731' %};"></div>

            <h4 class="fw-bold mt-1">{{ s.site_name }}</h4>
            <p class="text-muted mb-2">
                <b>üìç Location:</b> {{ s.location|default:"Not provided" }}
            </p>

            <hr class="mt-3 mb-3">

            <div class="d-flex justify-content-end">
                <a href="{% url 'site_detail' s.id %}" class="view-btn">View Site ‚Üí</a>
            </div>
        </div>
        {% endfor %}

    </div>
    
</div>


<!-- JS: Search Filter -->
<script>
function searchSites() {
    let input = document.getElementById("searchBox").value.toLowerCase();
    let cards = document.querySelectorAll(".site-item");

    cards.forEach(card => {
        let name = card.querySelector("h4").innerText.toLowerCase();
        card.style.display = name.includes(input) ? "" : "none";
    });
}
</script>

{% endblock %}
